
<!DOCTYPE html>

<html lang="spanish">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Conjunto R&amp;D &#8212; Búsqueda de nueva física utilizando técnicas de aprendizaje automático en eventos de múltiples jets</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="spanish">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo_ucv.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Búsqueda de nueva física utilizando técnicas de aprendizaje automático en eventos de múltiples jets</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Buscar este libro ..." aria-label="Buscar este libro ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../marco-teorico/resumen.html">
   1. Marco teórico
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../marco-teorico/modelo-estandar.html">
     1.1. El módelo estándar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../marco-teorico/cromodinamica-cuantica.html">
     1.2. Cromodinámica cuántica
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../marco-teorico/reconstruccion-jets.html">
     1.3. Reconstrucción de jets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../marco-teorico/mas-alla-del-ms.html">
     1.4. Más allá del modelo estándar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../marco-teorico/aprendizaje-automatico.html">
     1.5. Aprendizaje automático
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../marco-teorico/reproducibilidad.html">
     1.6. Reproducibilidad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../marco-teorico/olimpiadas-LHC.html">
     1.7. Olimpiadas LHC 2020
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../referencias/referencias.html">
   2. Referencias
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Navegación de palanca" aria-controls="site-navigation"
                title="Navegación de palanca" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Descarga esta pagina"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/capitulos/analisis-datos/conjunto-RnD.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Descargar archivo fuente" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimir en PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/marianaiv/tesis_grado_UCV"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Repositorio de origen"><i
                    class="fab fa-github"></i>repositorio</button></a>
        <a class="issues-button"
            href="https://github.com/marianaiv/tesis_grado_UCV/issues/new?title=Issue%20on%20page%20%2Fcapitulos/analisis-datos/conjunto-RnD.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Abrir un problema"><i class="fas fa-lightbulb"></i>Tema abierto</button></a>
        <a class="edit-button" href="https://github.com/marianaiv/tesis_grado_UCV/edit/marco-teorico/tesis/capitulos/analisis-datos/conjunto-RnD.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edita esta página"><i class="fas fa-pencil-alt"></i>sugerir editar</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Modo de pantalla completa"
        title="Modo de pantalla completa"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/marianaiv/tesis_grado_UCV/marco-teorico?urlpath=tree/tesis/capitulos/analisis-datos/conjunto-RnD.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Lanzamiento Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contenido
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datos-crudos">
   Datos crudos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datos-pre-procesados">
   Datos pre-procesados
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Conjunto R&D</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contenido </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datos-crudos">
   Datos crudos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datos-pre-procesados">
   Datos pre-procesados
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="conjunto-r-d">
<span id="rnd"></span><h1>Conjunto R&amp;D<a class="headerlink" href="#conjunto-r-d" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="margin figure align-default" id="rnd-rnd">
<img alt="../../_images/lhco-RnD.png" src="../../_images/lhco-RnD.png" />
<p class="caption"><span class="caption-text">Diagrama de Feynmann para la señal.</span><a class="headerlink" href="#rnd-rnd" title="Enlace permanente a esta imagen">¶</a></p>
</div>
<p>Como se mencionó en la <a class="reference internal" href="../marco-teorico/olimpiadas-LHC.html#lhco-datos"><span class="std std-numref">Sección 1.7.1</span></a>, el conjunto R&amp;D posee 1,000,000 de eventos de fondo y 100,000 de señal (aproximadamente 9.09% de los eventos son señal). La señal se trata de <span class="math notranslate nohighlight">\(Z'\rightarrow XY\)</span> con <span class="math notranslate nohighlight">\(X\rightarrow q\bar{q}\)</span> y <span class="math notranslate nohighlight">\(Y\rightarrow q\bar{q}\)</span>. Con masas de 3.5 TeV, 500 GeV y 100 GeV para <em>Z'</em>, <em>X</em> y <em>Y</em>, respectivamente.</p>
<p>El archivo R&amp;D publicado por las LHCO 2020 es de la siguiente forma:</p>
<table class="colwidths-auto table" id="rnd-raw">
<caption><span class="caption-text">Estructura del conjunto de datos R&amp;D. Cada fila es un evento y la última columna hace referencia a si el evento es de fondo (0) o de señal (1).</span><a class="headerlink" href="#rnd-raw" title="Enlace permanente a esta tabla">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Evento</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(pT\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\eta\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\phi\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(pT\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\eta\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\phi\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></th>
<th class="head"><p>señal</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\vdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></td>
<td><p>0.0</p></td>
</tr>
</tbody>
</table>
<p>Este conjunto de datos tiene 1,100,000 eventos. Cada 3 columnas representan el <span class="math notranslate nohighlight">\(p_T\)</span>, <span class="math notranslate nohighlight">\(\eta\)</span> y <span class="math notranslate nohighlight">\(\phi\)</span> de un hadrón, con relleno de ceros hasta 700 hadrones. Por lo tanto los datos se encuentran organizados en una tabla de <span class="math notranslate nohighlight">\(1,100,000\times2101\)</span>, tomando en cuenta la columna de señal.</p>
<p>A continuación se va a presentar un análisis de los datos. Para ello utilizaremos 100,000 eventos del conjunto de datos.</p>
<div class="section" id="datos-crudos">
<span id="id1"></span><h2>Datos crudos<a class="headerlink" href="#datos-crudos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Al cargar los datos en una tabla se ven de la siguiente forma,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importamos las librerías principales</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Funciones de benchtools</span>
<span class="kn">from</span> <span class="nn">benchtools.src.plotools</span> <span class="kn">import</span> <span class="n">bkg_sig_hist</span>
<span class="kn">from</span> <span class="nn">benchtools.src.clustering</span> <span class="kn">import</span> <span class="n">build_features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_492</span><span class="o">/</span><span class="mf">1782456959.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Importamos las librerías principales</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargamos 100,000 eventos</span>
<span class="n">path_data</span> <span class="o">=</span> <span class="s2">&quot;../../../datos/events_anomalydetection.h5&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="n">path_data</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>2091</th>
      <th>2092</th>
      <th>2093</th>
      <th>2094</th>
      <th>2095</th>
      <th>2096</th>
      <th>2097</th>
      <th>2098</th>
      <th>2099</th>
      <th>2100</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.324101</td>
      <td>-0.361158</td>
      <td>2.737669</td>
      <td>0.409859</td>
      <td>-2.429939</td>
      <td>0.729830</td>
      <td>0.867922</td>
      <td>-2.267777</td>
      <td>-1.161310</td>
      <td>0.383031</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.646304</td>
      <td>-0.539460</td>
      <td>-1.386258</td>
      <td>0.471293</td>
      <td>-1.636572</td>
      <td>0.751657</td>
      <td>0.453769</td>
      <td>-1.099593</td>
      <td>-0.393405</td>
      <td>0.485929</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.325172</td>
      <td>-0.833948</td>
      <td>2.404844</td>
      <td>1.295058</td>
      <td>-2.089618</td>
      <td>-1.873342</td>
      <td>0.451272</td>
      <td>-0.101877</td>
      <td>2.217348</td>
      <td>0.461293</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.290918</td>
      <td>-2.200063</td>
      <td>1.630132</td>
      <td>0.565028</td>
      <td>-1.714345</td>
      <td>-2.617103</td>
      <td>0.951042</td>
      <td>-0.532720</td>
      <td>2.941473</td>
      <td>0.896248</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.526330</td>
      <td>-2.349110</td>
      <td>-1.745532</td>
      <td>0.542491</td>
      <td>-2.080352</td>
      <td>-3.044045</td>
      <td>0.390727</td>
      <td>-1.278563</td>
      <td>-2.131058</td>
      <td>2.530358</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 2101 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculamos la proporción de señal</span>
<span class="n">df_sig</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># Última columna es señal</span>
<span class="n">ratio_sig</span> <span class="o">=</span> <span class="n">df_sig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Guardamos el valor en el notebook</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;RnD-ratio&quot;</span><span class="p">,</span> <span class="n">ratio_sig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>La proporción de señal en este subconjunto de 100,000 eventos es del <span class="pasted-text">9.06</span>%. Cada evento tiene una cantidad distinta de hadrones,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminamos la señal para evitar contar los hadrones</span>
<span class="n">ns_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  

<span class="c1"># Contamos los valores de pT distintos de cero</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;n_hadrons&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ns_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,::</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>

<span class="c1"># Imprimimos para los primeros 5 eventos    </span>
<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Número de hadrones en el evento </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">event</span><span class="p">,</span><span class="s1">&#39;n_hadrons&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de hadrones en el evento 0: 109
Número de hadrones en el evento 1: 208
Número de hadrones en el evento 2: 196
Número de hadrones en el evento 3: 183
Número de hadrones en el evento 4: 169
</pre></div>
</div>
</div>
</div>
<p>Graficando las distribuciones de las variables podemos lograr una mejor idea del contenido los datos. Por ejemplo, podemos ver la distribución del número de hadrones para eventos de señal y de fondo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graficamos utilizando benchtools</span>
<span class="n">bkg_sig_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s1">&#39;n_hadrons&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="mi">2100</span><span class="p">)</span> <span class="c1"># label=2100 porque esa es la columna de señal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/conjunto-RnD_7_0.png" src="../../_images/conjunto-RnD_7_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separamos la señal del fondo</span>
<span class="n">df_sig</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># -2 porque agregamos columna de n_hadrons</span>
<span class="n">df_bkg</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span> 

<span class="c1"># Calculamos la media</span>
<span class="n">mean_had_sig</span> <span class="o">=</span> <span class="n">df_sig</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;n_hadrons&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_had_bkg</span> <span class="o">=</span> <span class="n">df_bkg</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;n_hadrons&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Guardamos los valores en el notebook</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;RnD-mean_had_sig&#39;</span><span class="p">,</span> <span class="n">mean_had_sig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;RnD-mean_had_bkg&#39;</span><span class="p">,</span> <span class="n">mean_had_bkg</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>La distribución del número de hadrones de los eventos de fondo es más ancha y con una media de <span class="pasted-text">171</span> con menor densidad de eventos. La distribución de la señal es mas angosta con una media de <span class="pasted-text">140</span>. Esto quiere decir que los eventos de señal tienden a tener menos hadrones.</p>
<p>Graficamos también también las distribuciones del promedio de <span class="math notranslate nohighlight">\(p_T\)</span>, <span class="math notranslate nohighlight">\(\eta\)</span> y <span class="math notranslate nohighlight">\(\phi\)</span> de los hadrones de cada evento, para todos los eventos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cada 3 valores es pT, cada 3 empezando por 1 es eta </span>
<span class="c1"># y cada 3 empezando por 2 es phi.</span>
<span class="c1"># Remplazamos los ceros con NaN para poder utilizar .mean()</span>

<span class="n">pt_df</span> <span class="o">=</span> <span class="n">ns_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,::</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
<span class="n">eta_df</span> <span class="o">=</span> <span class="n">ns_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
<span class="n">phi_df</span> <span class="o">=</span> <span class="n">ns_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">::</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>

<span class="c1"># Calculamos la media de cada evento</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;mean_pT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pt_df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;mean_eta&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">eta_df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;mean_phi&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">phi_df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Graficamos cada variable</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mean_pT&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_eta&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_phi&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">bkg_sig_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="mi">2100</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/conjunto-RnD_10_0.png" src="../../_images/conjunto-RnD_10_0.png" />
<img alt="../../_images/conjunto-RnD_10_1.png" src="../../_images/conjunto-RnD_10_1.png" />
<img alt="../../_images/conjunto-RnD_10_2.png" src="../../_images/conjunto-RnD_10_2.png" />
</div>
</div>
<p>Existe una diferencia entre la distribución de <span class="math notranslate nohighlight">\(p_T\)</span> del fondo y de la señal. En general, los eventos de fondo parecen tener menor <span class="math notranslate nohighlight">\(p_T\)</span> que los eventos de señal. Las variables <span class="math notranslate nohighlight">\(\eta\)</span> y <span class="math notranslate nohighlight">\(\phi\)</span> están distribuidas normalmente en los eventos de señal y de fondo.</p>
<p>A continuación agruparemos los jets y observaremos la distribución de las variables.</p>
</div>
<div class="section" id="datos-pre-procesados">
<span id="rnd-jets"></span><h2>Datos pre-procesados<a class="headerlink" href="#datos-pre-procesados" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Los datos pre-procesados de los primeros 100,000 eventos se obtienen utilizando <code class="docutils literal notranslate"><span class="pre">build_features</span></code> de <code class="docutils literal notranslate"><span class="pre">benchtools.src.clustering</span></code>, que utiliza la librería <code class="docutils literal notranslate"><span class="pre">pyjet</span></code>. Los detalles de este pre-procesamiento se encuentran en la <code class="xref std std-numref docutils literal notranslate"><span class="pre">bench-pre</span></code>.</p>
<p>Los datos de los jets agrupados que se obtienen del pre-procesamiento son de la siguiente forma,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_features</span><span class="p">(</span><span class="n">path_data</span><span class="o">=</span><span class="n">path_data</span><span class="p">,</span> <span class="n">nbatch</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">outname</span><span class="o">=</span><span class="s1">&#39;RnD-100000&#39;</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="s1">&#39;../../../datos/&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Part 1/2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 50000/50000 [19:14&lt;00:00, 43.32it/s] 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Part 2/2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 50000/50000 [17:26&lt;00:00, 47.77it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Done
Merging files
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../../../datos/RnD-100000.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pT_j1</th>
      <th>m_j1</th>
      <th>eta_j1</th>
      <th>phi_j1</th>
      <th>E_j1</th>
      <th>tau_21_j1</th>
      <th>nhadrons_j1</th>
      <th>pT_j2</th>
      <th>m_j2</th>
      <th>eta_j2</th>
      <th>phi_j2</th>
      <th>E_j2</th>
      <th>tau_21_j2</th>
      <th>nhadrons_j2</th>
      <th>m_jj</th>
      <th>deltaR_j12</th>
      <th>n_hadrons</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1286.727685</td>
      <td>106.912129</td>
      <td>0.185508</td>
      <td>-2.763676</td>
      <td>1313.290435</td>
      <td>0.624659</td>
      <td>36</td>
      <td>1283.220733</td>
      <td>63.164215</td>
      <td>0.064989</td>
      <td>0.393688</td>
      <td>1287.481934</td>
      <td>0.713248</td>
      <td>33</td>
      <td>2580.489568</td>
      <td>3.159663</td>
      <td>109.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1354.394070</td>
      <td>614.269108</td>
      <td>0.826505</td>
      <td>1.365524</td>
      <td>1943.559886</td>
      <td>0.311688</td>
      <td>84</td>
      <td>1325.613761</td>
      <td>439.064150</td>
      <td>-0.874319</td>
      <td>-1.786248</td>
      <td>1916.370744</td>
      <td>0.276881</td>
      <td>97</td>
      <td>3859.315047</td>
      <td>3.581406</td>
      <td>208.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1214.955723</td>
      <td>645.865619</td>
      <td>-0.196786</td>
      <td>2.040545</td>
      <td>1396.840654</td>
      <td>0.238205</td>
      <td>119</td>
      <td>1072.462085</td>
      <td>113.768840</td>
      <td>0.143831</td>
      <td>-1.090330</td>
      <td>1089.530630</td>
      <td>0.726963</td>
      <td>59</td>
      <td>2480.769725</td>
      <td>3.149348</td>
      <td>196.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1285.227873</td>
      <td>516.835248</td>
      <td>0.328693</td>
      <td>2.975321</td>
      <td>1450.485926</td>
      <td>0.013429</td>
      <td>65</td>
      <td>1220.251279</td>
      <td>174.796077</td>
      <td>0.294854</td>
      <td>-0.322661</td>
      <td>1285.618789</td>
      <td>0.706361</td>
      <td>89</td>
      <td>2609.893413</td>
      <td>3.298155</td>
      <td>183.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1210.415787</td>
      <td>129.499352</td>
      <td>-0.744836</td>
      <td>-2.883347</td>
      <td>1567.345300</td>
      <td>0.423550</td>
      <td>54</td>
      <td>1091.785816</td>
      <td>155.362262</td>
      <td>1.060534</td>
      <td>0.264977</td>
      <td>1772.340209</td>
      <td>0.787662</td>
      <td>57</td>
      <td>3313.488835</td>
      <td>3.629229</td>
      <td>169.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Estas variables son las que se van a utilizar para entrenar los modelos de aprendizaje automático. Algunas de estas poseen distribuciones diferentes para los eventos de señal y de fondo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pT_j1&#39;</span><span class="p">,</span><span class="s1">&#39;E_j1&#39;</span><span class="p">,</span> <span class="s1">&#39;m_j1&#39;</span><span class="p">,</span><span class="s1">&#39;tau_21_j1&#39;</span><span class="p">]:</span>
    <span class="n">bkg_sig_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/conjunto-RnD_15_0.png" src="../../_images/conjunto-RnD_15_0.png" />
<img alt="../../_images/conjunto-RnD_15_1.png" src="../../_images/conjunto-RnD_15_1.png" />
<img alt="../../_images/conjunto-RnD_15_2.png" src="../../_images/conjunto-RnD_15_2.png" />
<img alt="../../_images/conjunto-RnD_15_3.png" src="../../_images/conjunto-RnD_15_3.png" />
</div>
</div>
<p>Se observa que el <span class="math notranslate nohighlight">\(p_T\)</span> del fondo decae suavemente, indicando que los jets más energéticos de eventos de QCD tienden a tener un momento transverso menor a 1500 GeV. Los jets más energéticos de los eventos de señal poseen un <span class="math notranslate nohighlight">\(p_T\)</span> mayor, entre 1500 y 2000 GeV.</p>
<p>Esto también se observa en las distribuciones de energía. Los jets principales de eventos de fondo son más energéticos que los de eventos de señal</p>
<p>La distribución de masa del jet principal también es diferente. Para el fondo, los jets tienden a ser menos masivos y también decaen suavemente. Sin embargo, en los eventos de señal se observan dos picos alrededor de 100 y 500 GeV. Estas son las masas de las partículas <span class="math notranslate nohighlight">\(X\)</span> y <span class="math notranslate nohighlight">\(Y\)</span> del evento <span class="math notranslate nohighlight">\(Z'\rightarrow XY\)</span>.</p>
<p>Finalmente, se observa una diferencia en la distribución de la variable <span class="math notranslate nohighlight">\(\tau_21\)</span>. De acuerdo a su definición en <code class="xref std std-numref docutils literal notranslate"><span class="pre">ratio_subjettiness</span></code>, el valor de esta variable es menor cuando los jets poseen dos subjets. Por lo tanto, como la señal se agrupa hacia valores más pequeños, indica que los jets de señal son más consistentes con la estructura de dos subjets.</p>
<p>Algunas variables no presentan una diferencia tan marcada entre las distribuciones,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;eta_j1&#39;</span><span class="p">,</span> <span class="s1">&#39;nhadrons_j1&#39;</span><span class="p">,</span> <span class="s1">&#39;phi_j1&#39;</span><span class="p">]:</span>
    <span class="n">bkg_sig_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/conjunto-RnD_17_0.png" src="../../_images/conjunto-RnD_17_0.png" />
<img alt="../../_images/conjunto-RnD_17_1.png" src="../../_images/conjunto-RnD_17_1.png" />
<img alt="../../_images/conjunto-RnD_17_2.png" src="../../_images/conjunto-RnD_17_2.png" />
</div>
</div>
<p>Las distribuciones de <span class="math notranslate nohighlight">\(\eta\)</span> y el número de hadrones que constituyen el jet principal son más angostas para la señal. El ángulo <span class="math notranslate nohighlight">\(\phi\)</span> de los jets no presenta diferencias marcadas.</p>
<p>Por último, las variables que reprensentan una relación entre los dos jets principalestambién poseen diferencias,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;deltaR_j12&#39;</span><span class="p">,</span><span class="s1">&#39;m_jj&#39;</span><span class="p">]:</span>
    <span class="n">bkg_sig_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/conjunto-RnD_19_0.png" src="../../_images/conjunto-RnD_19_0.png" />
<img alt="../../_images/conjunto-RnD_19_1.png" src="../../_images/conjunto-RnD_19_1.png" />
</div>
</div>
<p>La distribución de <span class="math notranslate nohighlight">\(\Delta R\)</span> es más angosta para los eventos de señal. La masa invariante del fondo se encuentra entre 2000 y 3000 GeV, y decae suavemente, mientras que para la señal se observa un pico alrededor de 3500 GeV, consistente con la masa del bosón <span class="math notranslate nohighlight">\(Z'\)</span> de nueva física para el evento de este conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Queremos tener las correlaciones para la señal y el fondo en dataframes separados</span>
<span class="n">df_bkg</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">,</span><span class="s1">&#39;m_jj&#39;</span><span class="p">,</span><span class="s1">&#39;m_j1&#39;</span><span class="p">,</span><span class="s1">&#39;m_j2&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_sig</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">,</span><span class="s1">&#39;m_jj&#39;</span><span class="p">,</span><span class="s1">&#39;m_j1&#39;</span><span class="p">,</span><span class="s1">&#39;m_j2&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculamos las correlaciones</span>
<span class="n">df_bkg_corr</span> <span class="o">=</span> <span class="n">df_bkg</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">df_sig_corr</span> <span class="o">=</span> <span class="n">df_sig</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Para graficar el mapa de correlaciones:</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">corr</span> <span class="ow">in</span> <span class="p">[(</span><span class="s1">&#39;fondo&#39;</span><span class="p">,</span> <span class="n">df_bkg_corr</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;señal&#39;</span><span class="p">,</span> <span class="n">df_sig_corr</span><span class="p">)]:</span>
    
    <span class="c1"># Definimos figura y tamaño</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    
    <span class="c1"># Mapa de color</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
    
    <span class="c1">#Ejes</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">corr</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    
    <span class="c1"># Título</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlación: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/conjunto-RnD_21_0.png" src="../../_images/conjunto-RnD_21_0.png" />
<img alt="../../_images/conjunto-RnD_21_1.png" src="../../_images/conjunto-RnD_21_1.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./capitulos\analisis-datos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Por Mariana Vivas, Universidad Central de Venezuela<br/>
    
        &copy; Derechos de autor 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>